# –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –≤ Kubernetes

–î–∞–Ω–Ω–∞—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è —Å–æ–¥–µ—Ä–∂–∏—Ç –º–∞–Ω–∏—Ñ–µ—Å—Ç—ã Kubernetes –¥–ª—è —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è GitHub Insights Pro.

## üìö –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏ –¥–ª—è Frontend —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤

–ï—Å–ª–∏ –≤—ã –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ —Ä–∞–±–æ—Ç–∞–ª–∏ —Å Kubernetes –∏ Docker, –≤–æ—Ç —Ä–µ—Å—É—Ä—Å—ã –¥–ª—è –∏–∑—É—á–µ–Ω–∏—è:

### üê≥ Docker (–Ω–∞—á–Ω–∏—Ç–µ –æ—Ç—Å—é–¥–∞!)

- **[Docker –¥–ª—è –Ω–∞—á–∏–Ω–∞—é—â–∏—Ö](https://docs.docker.com/get-started/)** - –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- **[Docker Tutorial –¥–ª—è Frontend —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤](https://www.youtube.com/watch?v=3c-iBn73dDE)** - –≤–∏–¥–µ–æ –Ω–∞ —Ä—É—Å—Å–∫–æ–º
- **[–ö–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—è React –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π](https://habr.com/ru/articles/427067/)** - —Å—Ç–∞—Ç—å—è –Ω–∞ –•–∞–±—Ä–µ

### ‚ò∏Ô∏è Kubernetes (–ø–æ—Å–ª–µ –∏–∑—É—á–µ–Ω–∏—è Docker)

- **[Kubernetes –¥–ª—è –Ω–∞—á–∏–Ω–∞—é—â–∏—Ö](https://kubernetes.io/docs/tutorials/kubernetes-basics/)** - –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–µ —Ç—É—Ç–æ—Ä–∏–∞–ª—ã
- **[Kubernetes –∑–∞ 30 –º–∏–Ω—É—Ç](https://www.youtube.com/watch?v=TKf8nUJPEuI)** - –≤–∏–¥–µ–æ –Ω–∞ —Ä—É—Å—Å–∫–æ–º
- **[–ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ kubectl](https://kubernetes.io/docs/reference/kubectl/)** - —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –∫–æ–º–∞–Ω–¥

### üé• –í–∏–¥–µ–æ –∫—É—Ä—Å—ã

- **[Kubernetes –¥–ª—è Frontend —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤](https://www.youtube.com/playlist?list=PLqnpSHz8G6-QZ8bJO6nIhLdLL8KbqJNRh)** - —Å–µ—Ä–∏—è —É—Ä–æ–∫–æ–≤
- **[Docker + Kubernetes –¥–ª—è –≤–µ–±-—Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤](https://www.youtube.com/watch?v=s6H_KD9e7jE)**

## –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Kubernetes –∫–ª–∞—Å—Ç–µ—Ä (v1.19+)
- –ù–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π kubectl –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –∫–ª–∞—Å—Ç–µ—Ä—É
- –î–æ—Å—Ç—É–ø –∫ Docker registry (–¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Å–æ–±—Ä–∞–Ω–Ω—ã—Ö –æ–±—Ä–∞–∑–æ–≤)

> **üí° –°–æ–≤–µ—Ç:** –ï—Å–ª–∏ —É –≤–∞—Å –Ω–µ—Ç –∫–ª–∞—Å—Ç–µ—Ä–∞, –º–æ–∂–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å [minikube](https://minikube.sigs.k8s.io/docs/start/) –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –∏–ª–∏ [kind](https://kind.sigs.k8s.io/) –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è.

## –ü–æ—à–∞–≥–æ–≤–æ–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ

### 1. –°–±–æ—Ä–∫–∞ –∏ –∑–∞–≥—Ä—É–∑–∫–∞ Docker –æ–±—Ä–∞–∑–∞

```bash
# –°–±–æ—Ä–∫–∞ Docker –æ–±—Ä–∞–∑–∞
docker build -t your-registry/github-insights-pro:latest .

# –ó–∞–≥—Ä—É–∑–∫–∞ –≤ –≤–∞—à container registry
docker push your-registry/github-insights-pro:latest
```

> **üí° –°–æ–≤–µ—Ç –¥–ª—è –Ω–æ–≤–∏—á–∫–æ–≤:** –ï—Å–ª–∏ –Ω–µ –∑–Ω–∞–µ—Ç–µ, —á—Ç–æ —Ç–∞–∫–æ–µ registry - —ç—Ç–æ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ Docker –æ–±—Ä–∞–∑–æ–≤. –ü–æ–ø—É–ª—è—Ä–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã: Docker Hub, Google Container Registry, AWS ECR, GitHub Container Registry.

### 2. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Å—ã–ª–∫–∏ –Ω–∞ –æ–±—Ä–∞–∑

–û–±–Ω–æ–≤–∏—Ç–µ —Å—Å—ã–ª–∫—É –Ω–∞ –æ–±—Ä–∞–∑ –≤ `deployment.yaml`:

```yaml
spec:
  template:
    spec:
      containers:
      - name: github-insights-pro
        image: your-registry/github-insights-pro:latest  # –û–±–Ω–æ–≤–∏—Ç–µ —ç—Ç–æ
```

### 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–µ–∫—Ä–µ—Ç–æ–≤

–û–±–Ω–æ–≤–∏—Ç–µ GitHub —Ç–æ–∫–µ–Ω –≤ `secret.yaml`:

```bash
# –ö–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ GitHub —Ç–æ–∫–µ–Ω–∞ –≤ base64
echo -n "your-github-token" | base64

# –û–±–Ω–æ–≤–∏—Ç–µ —Ñ–∞–π–ª secret.yaml —Å –∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–Ω—ã–º –∑–Ω–∞—á–µ–Ω–∏–µ–º
```

> **‚ö†Ô∏è –í–∞–∂–Ω–æ:** –ù–∏–∫–æ–≥–¥–∞ –Ω–µ —Ö—Ä–∞–Ω–∏—Ç–µ —Å–µ–∫—Ä–µ—Ç—ã –≤ –æ—Ç–∫—Ä—ã—Ç–æ–º –≤–∏–¥–µ! Kubernetes –∏—Å–ø–æ–ª—å–∑—É–µ—Ç base64 –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–µ–∫—Ä–µ—Ç–æ–≤.

### 4. –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –≤ Kubernetes

```bash
# –°–æ–∑–¥–∞–Ω–∏–µ namespace –∏ —Ä–µ—Å—É—Ä—Å–æ–≤
kubectl apply -f namespace.yaml
kubectl apply -f configmap.yaml
kubectl apply -f secret.yaml
kubectl apply -f deployment.yaml
kubectl apply -f service.yaml

# –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ ingress –∏ HPA
kubectl apply -f ingress.yaml
kubectl apply -f hpa.yaml
```

### 5. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–æ–≤ (pods)
kubectl get pods -n github-insights-pro

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ—Ä–≤–∏—Å–æ–≤
kubectl get svc -n github-insights-pro

# –ü—Ä–æ–≤–µ—Ä–∫–∞ ingress (–µ—Å–ª–∏ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç)
kubectl get ingress -n github-insights-pro
```

> **üîç –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏:**
>
> - `kubectl describe pod <pod-name>` - –¥–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–¥–µ
> - `kubectl logs <pod-name>` - –ª–æ–≥–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
> - `kubectl port-forward svc/github-insights-pro 3000:3000` - –¥–æ—Å—Ç—É–ø –∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—é –ª–æ–∫–∞–ª—å–Ω–æ

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

- `NODE_ENV`: –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –≤ "production"
- `NEXT_PUBLIC_GITHUB_TOKEN`: GitHub API —Ç–æ–∫–µ–Ω –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è–º

### –õ–∏–º–∏—Ç—ã —Ä–µ—Å—É—Ä—Å–æ–≤

–†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –≤–∫–ª—é—á–∞–µ—Ç –∑–∞–ø—Ä–æ—Å—ã –∏ –ª–∏–º–∏—Ç—ã —Ä–µ—Å—É—Ä—Å–æ–≤:

- **–ü–∞–º—è—Ç—å**: 128Mi –∑–∞–ø—Ä–æ—Å, 512Mi –ª–∏–º–∏—Ç
- **CPU**: 100m –∑–∞–ø—Ä–æ—Å, 500m –ª–∏–º–∏—Ç

> **üí° –û–±—ä—è—Å–Ω–µ–Ω–∏–µ –¥–ª—è –Ω–æ–≤–∏—á–∫–æ–≤:**
>
> - **Request** - –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã –¥–ª—è –ø–æ–¥–∞
> - **Limit** - –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–æ–¥
> - **100m** = 100 –º–∏–ª–ª–∏CPU (0.1 CPU —è–¥—Ä–∞)

### –ü—Ä–æ–≤–µ—Ä–∫–∏ –∑–¥–æ—Ä–æ–≤—å—è

- **Liveness Probe**: HTTP GET –Ω–∞ –ø–æ—Ä—Ç—É 3000, –Ω–∞—á–∞–ª—å–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ 30—Å, –ø–µ—Ä–∏–æ–¥ 10—Å
- **Readiness Probe**: HTTP GET –Ω–∞ –ø–æ—Ä—Ç—É 3000, –Ω–∞—á–∞–ª—å–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ 5—Å, –ø–µ—Ä–∏–æ–¥ 5—Å

### –ê–≤—Ç–æ–º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ

HPA –Ω–∞—Å—Ç—Ä–æ–µ–Ω –Ω–∞ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç 2 –¥–æ 10 —Ä–µ–ø–ª–∏–∫ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è CPU –∏ –ø–∞–º—è—Ç–∏ (–ø–æ—Ä–æ–≥ 80%).

## –ö–∞—Å—Ç–æ–º–∏–∑–∞—Ü–∏—è

### Ingress

–û–±–Ω–æ–≤–∏—Ç–µ ingress.yaml —Å –≤–∞—à–∏–º –¥–æ–º–µ–Ω–æ–º –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ certificate manager.

### –õ–∏–º–∏—Ç—ã —Ä–µ—Å—É—Ä—Å–æ–≤

–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∑–∞–ø—Ä–æ—Å—ã –∏ –ª–∏–º–∏—Ç—ã —Ä–µ—Å—É—Ä—Å–æ–≤ –≤ deployment.yaml –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å –≤–∞—à–∏–º–∏ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º–∏.

### –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ

–ò–∑–º–µ–Ω—è–π—Ç–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é HPA –∏–ª–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–µ–ø–ª–∏–∫ –≤ deployment –ø–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏.

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

–ï—Å–ª–∏ –≤—ã —Ç–æ–ª—å–∫–æ –Ω–∞—á–∏–Ω–∞–µ—Ç–µ —Ä–∞–±–æ—Ç–∞—Ç—å —Å Kubernetes:

1. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ minikube** –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –∫–ª–∞—Å—Ç–µ—Ä–∞
2. **–ò–∑—É—á–∏—Ç–µ –±–∞–∑–æ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã kubectl** (get, describe, logs)
3. **–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∑–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–æ—Å—Ç–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ** –ø–µ—Ä–µ–¥ —ç—Ç–∏–º –ø—Ä–æ–µ–∫—Ç–æ–º
4. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ kubectl port-forward** –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ —Å–µ—Ä–≤–∏—Å–∞–º –ª–æ–∫–∞–ª—å–Ω–æ

## ‚ùì –ß–∞—Å—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

- **–ü–æ–¥ –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è** ‚Üí –ø—Ä–æ–≤–µ—Ä—å—Ç–µ `kubectl describe pod <pod-name>`
- **–ù–µ –º–æ–≥—É –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—é** ‚Üí –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `kubectl port-forward`
- **–û—à–∏–±–∫–∏ —Å –æ–±—Ä–∞–∑–∞–º–∏** ‚Üí —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –æ–±—Ä–∞–∑ –∑–∞–≥—Ä—É–∂–µ–Ω –≤ registry
